# Taken voor leerlingen laptops
# playbooks/leerlingen.yml
- name: Installeer GIMP (user)
  community.general.flatpak:
    name: org.gimp.GIMP
    state: present
    method: user
    remote: flathub

- name: Zorg dat Steam (user) VERWIJDERD is
  community.general.flatpak:
    name: com.valvesoftware.Steam
    state: present # absent # Zorgt ervoor dat het niet ge√Ønstalleerd is
    method: user
    remote: flathub

# - name: Zet school achtergrond
#   community.general.dconf:
#     key: "/org/gnome/desktop/background/picture-uri"
#     value: "'file:///usr/share/backgrounds/coolbx/archi.png'"

- name: Zet window menubar layout
  community.general.dconf:
    key: "/org/gnome/desktop/wm/preferences/button-layout"
    # value: "'appmenu:maximize,close'"
    value: "'appmenu:minimize,maximize,close'"

- name: Wallpaper setup
  block:
    # 1. Maak een mapje voor de achtergronden (in de user home)
    - name: Zorg dat de background map bestaat
      ansible.builtin.file:
        path: "{{ lookup('env', 'HOME') }}/.local/share/backgrounds"
        state: directory
        mode: '0755'

    # 2. Download de afbeelding van Unsplash
    - name: Download de wallpaper van Unsplash
      ansible.builtin.get_url:
        # Jouw Unsplash link:
        # url: "https://unsplash.com/photos/dKJXkKCF2D8/download?ixid=M3wxMjA3fDB8MXxhbGx8fHx8fHx8fHwxNzYzNDc1MjA3fA&force=true&w=2400"
        url: "https://unsplash.com/photos/3l3RwQdHRHg/download?ixid=M3wxMjA3fDB8MXxhbGx8fHx8fHx8fHwxNzYzNDc0MDQ0fA&force=true&w=2400"
        # url: "https://unsplash.com/photos/4fvS9uU1Reo/download?ixid=M3wxMjA3fDB8MXxzZWFyY2h8M3x8bGl2ZSUyMHdhbGxwYXBlcnN8ZW58MHx8fHwxNzYzNDcyMTc0fDA&force=true&w=1920"
        # We slaan het op met een vaste naam.
        # Als je de URL hierboven verandert, overschrijft Ansible dit bestand.
        dest: "{{ lookup('env', 'HOME') }}/.local/share/backgrounds/current_wallpaper.jpg"
        force: true # Forceer download (handig als Unsplash redirect)
        mode: '0644'

    # 3. Stel de gedownloade afbeelding in als achtergrond
    - name: Activeer de wallpaper via dconf
      community.general.dconf:
        key: "/org/gnome/desktop/background/picture-uri"
        # Let op de quotes! "'file://...'"
        # We gebruiken dark-mode uri ook voor de zekerheid
        value: "'file://{{ lookup('env', 'HOME') }}/.local/share/backgrounds/current_wallpaper.jpg'"
      
    - name: Activeer de wallpaper ook voor Dark Mode
      community.general.dconf:
        key: "/org/gnome/desktop/background/picture-uri-dark"
        value: "'file://{{ lookup('env', 'HOME') }}/.local/share/backgrounds/current_wallpaper.jpg'"